#!/bin/sh

# Test battery
a=$(battery)
[ "$a" == "0 0 0 0 0 0 0 0 0 0 0 0" ] && {
	logger -p user.info -t "self-test" battery[$a] error
} || {
	logger -p user.info -t "self-test" battery[$a] ok
}

# Test router connection
ping -c 1 192.168.1.64 >> /dev/null
[ $? == 0 ] && {
	logger -p user.info -t "self-test" router[192.168.1.1] ok
} || {
	logger -p user.info -t "self-test" router[192.168.1.1] error
}

# Test camera connection
ping -c 1 192.168.1.60 >> /dev/null
[ $? == 0 ] && {
	logger -p user.info -t "self-test" camera[192.168.1.64] ok
} || {
	logger -p user.info -t "self-test" camera[192.168.1.64] error
}

# Log disk space information
vs=$(df -h / | grep /$)
v2=$(echo $vs | awk '{print $2}')
v3=$(echo $vs | awk '{print $3}')
v4=$(echo $vs | awk '{print $4}')
v5=$(echo $vs | awk '{print $5}')
logger -p user.info -t "self-test" disk[/] Size: $v2, Used: $v3, Available: $v4, Use%: $v5

exit 0

