#!/bin/sh

ADV7182_ADDR=0x21
ADV7430_ADDR=0x6b

I2CW="i2cset -f -y"

config() {
	echo -n "Configure ADV7182 and ADV7430 ..."

	#7182芯片配置：
	#42 0F 00 42 00 00 42 02 04 42 07 00 42 03 0C 42 1D 40 42 13 00

	${I2CW} ${ADV7182_ADDR} 0x0f 0x00
	${I2CW} ${ADV7182_ADDR} 0x00 0x00
	${I2CW} ${ADV7182_ADDR} 0x02 0x04
	${I2CW} ${ADV7182_ADDR} 0x07 0x00
	${I2CW} ${ADV7182_ADDR} 0x03 0x0c
	${I2CW} ${ADV7182_ADDR} 0x1d 0x40
	${I2CW} ${ADV7182_ADDR} 0x13 0x00


	#7340芯片配置
	#D6 17 02 D6 00 FC D6 01 00 D6 80 11 D6 82 C1 D6 88 00 D6 8C 00 D6 8D 00 D6 8E 00 D6 8F 2A D6 87 20

	${I2CW} ${ADV7430_ADDR} 0x17 0x02
	${I2CW} ${ADV7430_ADDR} 0x00 0xfc
	${I2CW} ${ADV7430_ADDR} 0x01 0x00
	${I2CW} ${ADV7430_ADDR} 0x80 0x11
	${I2CW} ${ADV7430_ADDR} 0x82 0xc1
	${I2CW} ${ADV7430_ADDR} 0x88 0x00
	${I2CW} ${ADV7430_ADDR} 0x8c 0x00
	${I2CW} ${ADV7430_ADDR} 0x8d 0x00
	${I2CW} ${ADV7430_ADDR} 0x8e 0x00
	${I2CW} ${ADV7430_ADDR} 0x8f 0x2a
	${I2CW} ${ADV7430_ADDR} 0x87 0x20

	if [ $? -eq 0]; then
		echo "OK"
	else
		echo "FAILED"
	fi
}

case $1 in
	start)
		config
		;;
	stop)
		;;
	reload|restart)
		 config
		;;
	*)
		echo "Usage: $0 [start|stop|reload|restart]"
		exit 1
		;;
esac

exit $?
